import React from 'react'

import { useTranslation } from 'react-i18next'
import { SocialChat } from '@fs/zion-icon'
import { useChatOverlay, useHasUnreadChats } from '@fs/zion-chat'
import { trackEvent } from '@fs/zion-analytics'
import HeaderIconButton from '../HeaderIconButton/HeaderIconButton'

export default function HeaderChatButton() {
  const { t } = useTranslation()
  const { handleClick, isOpen } = useChatOverlay()
  const { hasUnreadChats } = useHasUnreadChats(isOpen)
  const title = hasUnreadChats ? t('header.chat.new', 'New chats available') : t('header.chat', 'Chat')

  return (
    <HeaderIconButton
      Icon={SocialChat}
      title={title}
      onClick={(event) => {
        handleClick(event)
        trackEvent({ event_name: 'header:chat:clicked' })
      }}
      dotted={hasUnreadChats}
      data-selector="chatOverlayButton"
    />
  )
}
