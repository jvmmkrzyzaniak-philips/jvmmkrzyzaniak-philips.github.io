import { ListItem, Row } from '@fs/zion-ui'
import React from 'react'
import { buildChatRoute, CHAT_ROUTE_KEY, ChatOverlayButton } from '@fs/zion-chat'
import { useTranslation } from 'react-i18next'
import { useGroupsContext } from '../../providers/GroupsProvider/InnerGroupsProvider'

export default function GroupBlock(): JSX.Element | null {
  const [t] = useTranslation()
  const { currentGroup, isResearcherGroup } = useGroupsContext()
  if (!currentGroup) return null

  const { imageUrl, name, id, chatChannelCid } = currentGroup

  return (
    <Row>
      <ListItem
        emphasized
        linkName={`tree details chip ${isResearcherGroup ? 'CET' : 'FGT'} link clicked`}
        data-testid="tree-details-chip-view-group-item"
        startElement={<ListItem.Avatar monogram={name[0]} src={imageUrl} />}
        primaryText={name}
        secondaryText={!isResearcherGroup ? t('groups.block.view-group') : t('groups.block.view-cet')}
        external
        to={`/groups/${isResearcherGroup ? 'research-tree' : 'family'}/${id}`}
      />
      <div growX />
      <ChatOverlayButton
        data-testid="member-actions.message-group.button"
        linkName="group-block:group:message group button: new chat"
        primaryText={t('groups.group-chat.action')}
        chatRoute={chatChannelCid ? buildChatRoute(CHAT_ROUTE_KEY.CHAT, { cid: chatChannelCid }) : undefined}
      />
    </Row>
  )
}
