import { PersonAdd } from '@fs/zion-icon'
import { ListItem, useOverlay } from '@fs/zion-ui'
import React, { lazy, Suspense } from 'react'
import { useTranslation } from 'react-i18next'
import { useGroupsContext } from '../../providers/GroupsProvider/InnerGroupsProvider'

const GroupInviteOverlay = lazy(() => import('../_flows/invite/GroupInviteOverlay'))

export default function InviteMemberListItem(): JSX.Element | null {
  const [t] = useTranslation()
  const inviteOverlay = useOverlay()
  const { currentGroup, isResearcherGroup } = useGroupsContext()

  if (!currentGroup) return null

  return (
    <>
      <ListItem
        linkName="Navigation: Invite Member"
        data-testid="navigation-invite-member"
        startElement={<ListItem.Icon Icon={PersonAdd} />}
        primaryText={
          !isResearcherGroup
            ? t('groups.navigation.invite-group-member')
            : t('groups.navigation.invite-group-member-cet')
        }
        onClick={inviteOverlay.handleClick}
      />
      <Suspense fallback="">
        {(inviteOverlay.isOpen || inviteOverlay.transitioning) && (
          <GroupInviteOverlay
            overlay={inviteOverlay}
            groupId={currentGroup.id}
            groupTypes={currentGroup.types}
            groupName={currentGroup.name}
          />
        )}
      </Suspense>
    </>
  )
}
